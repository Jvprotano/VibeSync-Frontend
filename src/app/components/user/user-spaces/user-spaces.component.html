<app-header [user]="user"></app-header>
<div class="container mt-5">
  <div class="row">
    <div class="col-12">
      <div class="d-md-flex align-items-center justify-content-between">
        <div>
          <h1 class="user-spaces-title">Olá, {{ user?.name }}</h1>
          <h6 *ngIf="canCreateSpaces() > 0">O seu plano permite criar mais {{canCreateSpaces()}} spaces</h6>
          <h6 *ngIf="canCreateSpaces() === 0">Você atingiu o limite de spaces do seu plano</h6>
        </div>
        <div style="display: flex;">
          <button *ngIf="canCreateSpaces() > 0" (click)="createSpace()"
            class="create-space-button d-flex align-items-center justify-content-center"><span class="me-2">Criar Novo
              Space</span><mat-icon>add</mat-icon></button>
          <a *ngIf="canCreateSpaces() === 0" routerLink="/pricing"
            class="create-space-button d-flex align-items-center justify-content-center"><span class="me-2">Faça Upgrade
              Agora</span><mat-icon>diamond</mat-icon></a>
          <button *ngIf="hasPaidPlan()" mat-icon-button [matMenuTriggerFor]="settingsMenu" class="ms-2"
            aria-label="Configurações do plano">
            <mat-icon>settings</mat-icon>
          </button>
          <mat-menu #settingsMenu="matMenu">
            <button mat-menu-item (click)="cancelSubscription()">
              <span style="color: #e53935;">Cancelar assinatura</span>
            </button>
          </mat-menu>
        </div>
      </div>
      <h4 class="my-3">Meus Spaces</h4>
      <section class="row row-gap-4 user-spaces-list">
        <div *ngFor="let space of spaces" class="col-md-4 space-cards-grid">
          <div class="space-card">
            <h3>{{ space.name }}</h3>
            <h5>Data do evento: {{ space.eventDate | date: 'dd/MM/yyyy' }}</h5>
            <h5>Sugestões: {{space.suggestionsCount}}</h5>
            <button (click)="navigateToSpace(space.adminToken)" class="space-card-button">Acessar Space</button>
          </div>
        </div>
        <div *ngIf="spaces.length === 0" class="no-spaces-message">
          <p>Nenhum Space disponível.</p>
        </div>
      </section>
    </div>
  </div>
</div>